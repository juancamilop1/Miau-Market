<header class="app-header">
  <div class="header-left">
    <a class="brand" routerLink="/login">
      <img src="/miauMarket.png" alt="Logo MiauMarket" class="brand-logo" data-brand="logo" />
    </a>

    <!-- Usuario y cerrar sesi贸n a la izquierda cuando est谩 logueado -->
    <ng-container *ngIf="auth.isLogged()">
      <span class="user-name">{{ auth.user()?.name }}</span>
      <button class="btn btn-ghost" (click)="auth.logout()">Cerrar sesi贸n</button>
    </ng-container>
    
    <!-- Navegaci贸n cuando NO est谩 logueado -->
    <ng-container *ngIf="!auth.isLogged()">
      <a class="nav-link" routerLink="/login" routerLinkActive="active">Iniciar sesi贸n</a>
      <a class="nav-link" routerLink="/register" routerLinkActive="active">Registrarse</a>
    </ng-container>
  </div>

  <div class="header-center">
    <div class="header-search" *ngIf="auth.isLogged()">
      <input class="input" placeholder="Buscar productos..." [value]="auth.search()" (input)="auth.search.set($any($event.target).value)" />
    </div>
  </div>

  <div class="header-right">
    <!-- Tienda y Carrito a la derecha cuando est谩 logueado -->
    <ng-container *ngIf="auth.isLogged()">
      <a class="nav-link" routerLink="/shop" routerLinkActive="active">Tienda</a>
      <a class="nav-link" routerLink="/cart" routerLinkActive="active">Carrito</a>
      <!-- Bot贸n de Administraci贸n solo para admins -->
      <a class="nav-link admin-link" routerLink="/admin" routerLinkActive="active" *ngIf="auth.user()?.is_staff">
        Administraci贸n
      </a>
    </ng-container>
    
    <!-- Bot贸n de tema siempre visible -->
    <button class="btn btn-ghost theme-toggle" type="button" (click)="toggleTheme()" title="Cambiar tema">
       <span class="sr-only">Alternar modo oscuro</span>
    </button>
  </div>

</header>

<main class="app-main">
  <router-outlet />
  <!-- El contenido de login/register aparece aqu铆 -->
</main>

<!-- Chatbot flotante global -->
<mm-chatbot *ngIf="auth.isLogged()"></mm-chatbot>
